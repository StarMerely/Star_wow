# Star WoW 辅助工具

一个用于 World of Warcraft 的 macOS 定时键盘输入辅助工具。

## 功能特性

### 键盘输入功能
- ⏰ **定时循环执行**：支持按分钟设置定时间隔，自动循环执行
- ⌨️ **自定义按键序列**：可自定义要输入的按键序列（默认：wwaass11）
- 🔄 **实时倒计时**：显示距离下次执行的剩余时间
- 📊 **执行统计**：记录已执行次数
- 🌙 **防休眠**：运行时防止系统休眠
- 🎯 **精确控制**：每个按键间隔 0.5 秒

### 🆕 OCR 图像识别功能
- 📸 **自动截屏**：定期抓取屏幕（可设置间隔，如 1 秒一次）
- 🔍 **文字识别**：使用 Apple Vision 框架识别屏幕上的所有文字
- 🌏 **多语言支持**：支持中文、英文识别
- 📍 **智能定位**：精确找到指定文字在屏幕上的坐标位置
- 🖱️ **模拟点击**：自动在找到的文字位置模拟鼠标点击
- 💯 **置信度评分**：显示识别准确度，支持条件过滤

## 使用方法

### 键盘输入功能

#### 1. 设置定时时间
- 输入框支持小数，例如：
  - `1` = 1 分钟
  - `0.5` = 30 秒
  - `0.1` = 6 秒

#### 2. 设置按键序列
- 输入要执行的按键，例如：
  - `wwaass11` - 依次按 w, w, a, a, s, s, 1, 1
  - `abc123` - 依次按 a, b, c, 1, 2, 3
  - `wspacea` - 按 w, 空格, a（空格用 `space` 表示）

#### 3. 启动定时器
- 点击"开始"按钮启动
- 定时器会循环执行，直到点击"结束"按钮

### 🆕 OCR 识别功能

#### 1. 切换到 OCR 标签页
- 打开应用后，点击 "OCR识别" 标签

#### 2. 设置扫描间隔
- 输入扫描间隔（推荐 1 秒）
- 点击"开始扫描"按钮

#### 3. 查找并点击文字
- 在"查找文字"输入框输入要查找的文字（如"确定"）
- 点击"查找并点击"按钮
- 应用会自动找到该文字并点击

#### 快速开始
详细使用说明请查看：[OCR 快速开始指南](MacWoWAuxiliary/QUICK_START.md)

## 构建应用

### 方法一：使用构建脚本（推荐）

```bash
# 在项目目录下运行
./build.sh
```

构建完成后，应用会自动复制到：
- 项目的 `build` 目录
- 桌面

### 方法二：使用 Xcode

1. 打开 `MacWoWAuxiliary.xcodeproj`
2. 选择 `Product` > `Archive`
3. 导出应用

## 权限设置

### 键盘输入功能权限

首次运行需要授予辅助功能权限：

1. 打开 **系统设置**
2. 进入 **隐私与安全性** > **辅助功能**
3. 添加 `MacWoWAuxiliary.app`

### 🆕 OCR 功能权限

使用 OCR 功能需要额外授予以下权限：

#### 1. 屏幕录制权限
1. 打开 **系统设置**
2. 进入 **隐私与安全性** > **屏幕录制**
3. 勾选 `MacWoWAuxiliary`

#### 2. 辅助功能权限（用于模拟点击）
1. 打开 **系统设置**
2. 进入 **隐私与安全性** > **辅助功能**
3. 勾选 `MacWoWAuxiliary`

⚠️ **重要**: 授予权限后需要重启应用

### 应用安全设置

如果提示"无法打开应用"，在终端运行：

```bash
xattr -cr ~/Desktop/MacWoWAuxiliary.app
```

详细权限配置请查看：[权限配置说明](MacWoWAuxiliary/PrivacyInfo.md)

## 技术栈

### 核心框架
- **SwiftUI** - 现代化的 UI 框架
- **Carbon Framework** - 键盘模拟
- **IOKit** - 防休眠功能

### 🆕 OCR 相关
- **Vision Framework** - Apple 官方 OCR 文字识别
- **CoreGraphics** - 屏幕截图和坐标处理
- **AppKit** - 系统交互和窗口管理

## 注意事项

### 通用注意事项
- ⚠️ 应用需要辅助功能权限才能模拟键盘输入
- ⚠️ 定时器运行时会防止系统休眠
- ⚠️ 建议连接电源使用
- ⚠️ 仅供学习和个人使用

### 🆕 OCR 功能注意事项
- ⚠️ OCR 识别需要屏幕录制权限
- ⚠️ 扫描间隔不宜过短（推荐 ≥ 1 秒）
- ⚠️ 识别准确度取决于文字清晰度
- ⚠️ 所有数据仅在本地处理，不会上传

## 项目结构

```
Star_wow/
├── MacWoWAuxiliary/
│   ├── MacWoWAuxiliaryApp.swift      # 应用入口
│   ├── ContentView.swift              # 主界面（含键盘输入和OCR功能）
│   ├── MenuBarManager.swift           # 菜单栏管理
│   ├── OCRManager.swift               # 🆕 OCR 识别管理类
│   ├── OCRUsageExample.swift          # 🆕 OCR 使用示例
│   ├── OCR_README.md                  # 🆕 OCR 功能说明
│   ├── QUICK_START.md                 # 🆕 快速开始指南
│   ├── PrivacyInfo.md                 # 🆕 权限配置说明
│   └── OCR_FEATURE_SUMMARY.md         # 🆕 功能总结
├── build.sh                           # 构建脚本
└── README.md                          # 本文件
```

## 📚 文档导航

- **[快速开始指南](MacWoWAuxiliary/QUICK_START.md)** - 5 分钟快速上手 OCR 功能
- **[OCR 功能说明](MacWoWAuxiliary/OCR_README.md)** - 详细的功能文档
- **[使用示例](MacWoWAuxiliary/OCRUsageExample.swift)** - 10+ 个代码示例
- **[权限配置](MacWoWAuxiliary/PrivacyInfo.md)** - 权限设置详解
- **[功能总结](MacWoWAuxiliary/OCR_FEATURE_SUMMARY.md)** - 完整功能总结

## 更新日志

### 🆕 v2.0.0 (2025-12-01)
- ✨ **新增 OCR 图像识别功能**
  - 📸 自动屏幕截图
  - 🔍 AI 文字识别（支持中英文）
  - 📍 智能文字定位
  - 🖱️ 自动模拟点击
  - 💯 置信度评分
- 🎨 UI 改进：使用 TabView 分离功能
- 📚 新增完整文档和示例代码

### v1.0.0 (2025-12-01)
- ✨ 初始版本
- ⏰ 定时循环执行功能
- ⌨️ 自定义按键序列
- 🔄 实时倒计时显示
- 🌙 防休眠功能
- 📊 执行统计

## 作者

Star

## 许可

仅供个人学习和使用
