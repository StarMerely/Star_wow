# 多文字点击功能更新说明

## 🆕 新增功能

### 支持多个文字依次点击

现在可以使用**分号 (;)** 分隔多个文字，应用会自动依次查找并点击它们！

---

## ✨ 功能特性

### 1. 分号分隔语法

在"查找文字"输入框中，使用分号分隔多个文字：

```
确定;开始;继续;完成
```

应用会依次：
1. 查找并点击 "确定"
2. 等待延迟时间
3. 查找并点击 "开始"
4. 等待延迟时间
5. 查找并点击 "继续"
6. 等待延迟时间
7. 查找并点击 "完成"

### 2. 可配置点击延迟

新增 **"点击延迟"** 输入框，可以设置每次点击之间的等待时间：

- **默认值**: 0.5 秒
- **推荐值**: 0.5 - 2 秒
- **用途**: 给应用足够时间响应每次点击

### 3. 实时反馈

点击完成后会显示结果消息：

```
完成! 成功点击 3/4 个文字
```

表示 4 个文字中成功找到并点击了 3 个。

---

## 🎯 使用方法

### UI 操作步骤

1. **切换到 OCR 识别标签页**
2. **开始扫描**: 点击"开始扫描"按钮
3. **输入多个文字**: 在"查找文字"框输入，如 `打开;确定;关闭`
4. **设置延迟**: 在"点击延迟"框输入延迟时间，如 `1`（秒）
5. **点击按钮**: 点击"查找并点击"
6. **查看结果**: 观察结果消息

### 代码示例

```swift
let ocrManager = OCRManager()

// 开始扫描
ocrManager.startScanning(interval: 1.0)

// 方法 1: 使用新的多文字点击方法
let result = ocrManager.findAndClickMultiple("确定;开始;继续", delayBetweenClicks: 0.5)
print("成功点击 \(result.success)/\(result.total) 个文字")

// 方法 2: 单个文字点击（仍然支持）
ocrManager.findAndClick("确定")
```

---

## 📋 新增 UI 元素

### 1. 查找文字输入框（已更新）

- **占位符**: "输入要查找的文字，多个用 ; 分隔"
- **宽度**: 300 像素（已扩大）
- **提示**: "支持中英文，多个文字用分号分隔，如: 确定;开始;继续"

### 2. 点击延迟输入框（新增）

- **标签**: "点击延迟 (秒):"
- **占位符**: "点击间隔"
- **默认值**: "0.5"
- **提示**: "多个文字点击之间的延迟时间，默认 0.5 秒"

### 3. 点击结果消息（新增）

- **位置**: 识别结果列表上方
- **颜色**: 蓝色
- **内容**: 显示点击成功数量和总数

---

## 🔧 技术实现

### OCRManager 新增方法

```swift
/// 查找并点击多个文字（使用分号分隔）
/// - Parameters:
///   - searchTexts: 要查找并点击的文字，使用分号分隔
///   - delayBetweenClicks: 每次点击之间的延迟（秒），默认 0.5 秒
/// - Returns: 成功点击的文字数量和总数的元组 (成功数, 总数)
@discardableResult
func findAndClickMultiple(_ searchTexts: String, delayBetweenClicks: TimeInterval = 0.5) -> (success: Int, total: Int)
```

### 实现逻辑

1. **分割文字**: 使用 `split(separator: ";")` 分割输入
2. **去除空格**: 使用 `trimmingCharacters(in: .whitespaces)` 清理
3. **依次点击**: 遍历每个文字，调用 `findAndClick()`
4. **添加延迟**: 使用 `Thread.sleep()` 在点击之间等待
5. **统计结果**: 返回成功和总数

### ContentView 更新

- 添加 `clickDelay` 状态变量
- 添加 `clickResultMessage` 状态变量
- 更新按钮逻辑：检测分号，调用相应方法
- 使用后台线程执行多文字点击，避免阻塞 UI

---

## 💡 使用场景

### 场景 1: 游戏自动化流程

```
输入: 打开背包;查看物品;领取奖励;关闭
延迟: 1 秒

效果: 自动完成整个领取奖励流程
```

### 场景 2: 表单填写

```
输入: 下一步;下一步;提交;确定
延迟: 0.5 秒

效果: 自动完成多步表单提交
```

### 场景 3: 对话框确认

```
输入: 同意;接受;确定;完成
延迟: 0.3 秒

效果: 快速通过多个确认对话框
```

### 场景 4: 菜单导航

```
输入: 设置;高级;性能;保存
延迟: 1 秒

效果: 自动导航到深层菜单并保存
```

---

## ⚙️ 配置建议

### 点击延迟设置

| 场景 | 推荐延迟 | 说明 |
|------|---------|------|
| **快速点击** | 0.3 - 0.5 秒 | 适合简单按钮点击 |
| **普通操作** | 0.5 - 1 秒 | 适合大多数场景 |
| **需要加载** | 1 - 2 秒 | 适合需要等待页面加载的场景 |
| **慢速操作** | 2 - 5 秒 | 适合需要长时间处理的操作 |

### 文字输入建议

1. **使用完整文字**: 输入完整的按钮文字，提高匹配准确度
2. **注意顺序**: 按照实际点击顺序输入文字
3. **去除空格**: 分号前后的空格会自动去除
4. **大小写**: 匹配时区分大小写

---

## 🐛 故障排除

### 问题 1: 某些文字未找到

**原因**: 
- 文字可能不在当前屏幕上
- 识别准确度不够
- 文字被遮挡

**解决方案**:
- 增加扫描间隔，确保识别完成
- 增加点击延迟，给页面加载时间
- 使用更完整的文字进行匹配

### 问题 2: 点击顺序错误

**原因**: 
- 输入顺序不正确

**解决方案**:
- 检查输入的文字顺序
- 确保分号正确分隔

### 问题 3: 点击太快

**原因**: 
- 延迟时间设置过短

**解决方案**:
- 增加点击延迟时间
- 推荐设置为 1 秒或更长

---

## 📊 性能影响

### 单个文字点击 vs 多个文字点击

| 指标 | 单个点击 | 多个点击 (3个) |
|------|---------|---------------|
| **执行时间** | ~0.1 秒 | ~1.6 秒 (含延迟) |
| **CPU 占用** | 低 | 低 |
| **内存占用** | 低 | 低 |
| **UI 响应** | 立即 | 后台执行 |

### 优化建议

1. **合理设置延迟**: 不要设置过长的延迟
2. **避免过多文字**: 建议不超过 10 个
3. **使用后台执行**: UI 不会被阻塞

---

## 🔄 兼容性

### 向后兼容

- ✅ 原有的单个文字点击功能完全保留
- ✅ 不包含分号的输入仍按单个文字处理
- ✅ 所有旧代码无需修改

### 新旧方法对比

```swift
// 旧方法（仍然支持）
ocrManager.findAndClick("确定")

// 新方法（推荐用于多个文字）
ocrManager.findAndClickMultiple("确定;开始;继续")

// 新方法也支持单个文字
ocrManager.findAndClickMultiple("确定")
```

---

## 📝 更新文件列表

### 修改的文件

1. **OCRManager.swift**
   - 新增 `findAndClickMultiple()` 方法

2. **ContentView.swift**
   - 新增 `clickDelay` 状态变量
   - 新增 `clickResultMessage` 状态变量
   - 更新查找文字输入框（宽度和提示）
   - 新增点击延迟输入框
   - 新增点击结果消息显示
   - 更新"查找并点击"按钮逻辑

3. **QUICK_START.md**
   - 添加多文字点击使用说明
   - 添加新的使用场景示例

4. **OCR_README.md**
   - 更新 API 文档
   - 添加新方法说明

5. **OCRUsageExample.swift**
   - 添加 `example3b_ClickMultipleTextsWithSemicolon()` 示例

---

## 🎉 总结

通过这次更新，OCR 功能现在支持：

✅ **单个文字点击** - 原有功能，快速简单  
✅ **多个文字点击** - 新增功能，自动化流程  
✅ **可配置延迟** - 灵活控制点击速度  
✅ **实时反馈** - 清晰显示执行结果  
✅ **向后兼容** - 不影响现有代码  

**开始使用多文字点击功能，让自动化更简单！** 🚀
